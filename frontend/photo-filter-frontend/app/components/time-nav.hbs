{{! frontend/photo-filter-frontend/app/components/time-nav.hbs }}

<div class="time-nav p-2 border border-gray-200 rounded">
  <h2 class="font-bold mb-2">Time</h2>

  {{#if this.isLoading}}
    <p>Loading time index...</p>
  {{else if this.timeIndex}}
    {{#each this.timeIndex.years as |yearObj|}}
      <div class="mb-2">
        {{! Instead of (buildDateKey), use (this.buildDateKey) }}
        {{#let (this.buildDateKey yearObj.year) as |yearKey|}}
          <label>
            <input
              type="checkbox"
              checked={{this.selectedDates.includes yearKey}}
              {{on "change" (fn this.toggleSelection yearKey)}}
            />
            <strong>{{yearObj.year}}</strong>
          </label>

          <div class="ml-4 mt-1">
            {{#each yearObj.months as |monthObj|}}
              {{#let
                (this.buildDateKey yearObj.year monthObj.month)
                as |monthKey|
              }}
                <div class="mb-1">
                  <label>
                    <input
                      type="checkbox"
                      checked={{this.selectedDates.includes monthKey}}
                      {{on "change" (fn this.toggleSelection monthKey)}}
                    />
                    Month
                    {{monthObj.month}}
                  </label>

                  <div class="ml-5 mt-1">
                    {{#each monthObj.days as |dayNumber|}}
                      {{#let
                        (this.buildDateKey
                          yearObj.year monthObj.month dayNumber
                        )
                        as |dayKey|
                      }}
                        <label class="mr-2">
                          <input
                            type="checkbox"
                            checked={{this.selectedDates.includes dayKey}}
                            {{on "change" (fn this.toggleSelection dayKey)}}
                          />
                          {{dayNumber}}
                        </label>
                      {{/let}}
                    {{/each}}
                  </div>
                </div>
              {{/let}}
            {{/each}}
          </div>
        {{/let}}
      </div>
    {{/each}}
  {{else}}
    <p>No time data found.</p>
  {{/if}}
</div>